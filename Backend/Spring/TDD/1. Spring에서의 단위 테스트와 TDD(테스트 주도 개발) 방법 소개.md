# 1. Spring에서의 단위 테스트와 TDD(테스트 주도 개발) 방법 소개
**Write** : 2023-02-14 18:12
**Tag** : #TDD #Junit
***
## 단위 테스트와 통합테스트
- 단위 테스트(Unit Test)는 프로그램에서 테스트를 할 수 있는 가장 작은 단위를 실행하여 단위가 정상적으로 흘러가는지를 테스트하는 것을 말한다.
- 통합 테스트(Integration Test)는 단위 테스트보다 큰 개념으로, 이제는 외부 환경까지 고려한 것들을 테스트한다.

#### 단위 테스트(Unit Test)를 작성해야 하는 이유
>단위 테스트를 작성해야 하는 이유는 정말 많다. 그 중에서 몇 가지 핵심적인 이유들을 작성하면 다음과 같다.
- 코드를 수정하거나 기능을 추가할 때 수시로 빠르게 검증 할 수 있다.
- 리팩토링 시에 안정성을 확보할 수 있다.
- 개발 및 테스팅에 대한 시간과 비용을 절감할 수 있다.

테스트 코드를 작성하면 우리가 <mark style="background: #FF5582A6;">작성한 코드들에 대해 수시로 빠르게 검증을 받을 수 있으며</mark>, 유지보수 및 리팩토링을 할 때에도 안정성을 확보할 수 있다는 장점이 있다. 하지만 그것보다 큰 장점으로 <mark style="background: #FF5582A6;">개발 및 테스팅에 대한 시간과 비용을 절감</mark>할 수 있다는 점에 주목해야 한다.

#### 좋은 테스트의 특징
>좋은 테스트의 특징은 FIRST라는 5가지 규칙을 따라야 한다
1. Fast: 테스트는 빠르게 동작하여 자주 돌릴 수 있어야 한다.
2. Independent: 각각의 테스트는 독립적이며 서로 의존해서는 안된다.
3. Repeatable: 어느 환경에서도 반복 가능해야 한다.
4. Self-Validating: 테스트는 성공 또는 실패로 bool 값으로 결과를 내어 자체적으로 검증되어야 한다.
5. Timely: 테스트는 적시에 즉, 테스트하려는 실제 코드를 구현하기 직전에 구현해야 한다.

## TDD(테스트 주도 개발), 테스트 코드를 먼저 작성해야 하는 이유와 방법 및 순서

#### 테스트 코드를 먼저 작성해야 하는 이유
>테스트 코드를 먼저 작성하는 개발 방법론은 테스트 주도 개발(Test-Driven Development, TDD)로 많이 불린다. 우리는 프로덕션 코드 보다 테스트 코드를 먼저 작성해야 하는데, 그 이뉴는 다음과 같다.
- 깔끔한 코드를 작성할 수 있다.
- 장기적으로 개발 비용을 절감할 수 있다.
- 개발이 끝나면 테스트 코드를 작성하는 것은 매우 귀찮다

#### TDD(Test-Driven Development, 테스트 주도 개발) 방법 및 순서
>TDD 개발 방법론의 프로그래밍 순서는 매우 단순하다.
1. 실패하는 작은 단위 테스트를 작성한다. 처음에는 컴파일조차 되지 않을 수 있다.
2. 빨리 테스트를 통과하기 위해 프로덕션 코드를 작성한다. 이를 위해 정답이 아닌 가짜 구현 등을 작성할 수도 있다.
3. 그 다음의 테스트 코드를 작성한다. 실패 테스트가 없을 경우에만 성공 테스트를 작성한다.
4. 새로운 테스트를 통과하기 위해 프로덕션 코드를 추가 또는 수정한다.
5. 1~4단계를 반복하여 실패/성공의 모든 테스트 케이스를 작성한다.
6. 개발된 코드들에 대해 모든 중복을 제거하며 리팩토링한다.

## Spring에서의 TDD 프로그래밍 방법
- Repository -> Service -> Controller 순서로 개발을 진행한다.
- Repository 계층의 테스트는 H2와 같은 인메모리 데이터베이스 기반의 통합 테스트로 진행한다.
- Service 계층의 테스트는 Mockito를 사용해 Repository 계층을 Mock하여 진행한다.
- Controller 계층의 테스트는 SpringTest의 MockMvc를 사용해 진행한다.